## 网络_每日八股

#### MTU MSS

MTU（Maximum Transmission Unit）是指**数据链路层网络帧中最大的数据字段大小**，它是一个网络设备所能发送的最大数据包大小。网络设备包括路由器、交换机和网卡等。通常，MTU 的大小是由链路层协议和硬件决定的，**比如以太网的 MTU 是 1500 字节。**

MSS（Maximum Segment Size）是指 **TCP 协议中数据段的最大大小**，它是一个端到端的值。由于 TCP 的数据段可能会被分割成多个 IP 分组进行传输，因此 MSS 的大小应该小于等于两个网络设备之间的 MTU，以确保 TCP 数据段不会被分割成更小的数据段，从而提高网络传输效率。

通常，**MTU 的大小是由网络设备的管理员进行配置的**，而 **MSS 的大小则是在 TCP 三次握手时根据对端的 MSS 值动态协商的**。在建立 TCP 连接时，客户端和服务器端都会发送自己的 MSS 值给对方，并根据对方的 MSS 值来确定两个网络设备之间的最大数据段大小。

---

#### ARP

1. 目标设备的 IP 地址在同一局域网中
   1. 主机A首先查看自己的ARP缓存表，确定其中是否包含有主机B对应的ARP表项。如果找到了对应的MAC地址，则主机A直接利用ARP表中的MAC地址，对IP数据包进行帧封装，并将数据包发送给主机B。
   2. 如果主机A在ARP表中找不到对应的MAC地址，则将缓存该数据报文，然后**以广播方式发送一个ARP请求报文**。ARP请求报文中的发送端IP地址和发送端MAC地址为主机A的IP地址和MAC地址，目标IP地址和目标MAC地址为主机B的IP地址和全0的MAC地址。由于ARP请求报文以广播方式发送，该网段上的所有主机都可以接收到该请求，但只有被请求的主机（即主机B）会对该请求进行处理。
   3. 主机B比较自己的IP地址和ARP请求报文中的目标IP地址，当两者相同时进行如下处理：将ARP请求报文中的发送端（即主机A）的IP地址和MAC地址存入自己的ARP表中。之后**以单播方式发送ARP响应报文给主机A，其中包含了自己的MAC地址。**
   4. 主机A收到ARP响应报文后，将主机B的MAC地址加入到自己的ARP表中以用于后续报文的转发，同时将IP数据包进行封装后发送出去。

2. 主机A和主机B不在同一网段时，主机A就会先向网关发出ARP请求，ARP请求报文中的目标IP地址为网关的IP地址。当主机A从收到的响应报文中获得网关的MAC地址后，将报文封装并发给网关。如果**网关没有主机B的ARP表项，网关会广播ARP请求，目标IP地址为主机B的IP地址，当网关从收到的响应报文中获得主机B的MAC地址后，就可以将报文发给主机B；如果网关已经有主机B的ARP表项，网关直接把报文发给主机B。**

---

#### 网络层转发数据报

1. 接收数据报：路由器的网络接口接收到一个数据报。
2. 解封装：如果数据报是经过隧道（tunnel）传输的，则需要解封装，获取内部的数据报。
3. 查找路由表：根据数据报中的**目的地址，在路由表中查找下一跳地址**。
4. TTL 减一：将数据报中的 **TTL 减一，如果 TTL 减到0，则数据报被丢弃**。
5. 选择下一跳：根据**路由表中的下一跳地址，选择向哪个网络接口发送数据报**。
6. 封装数据报：将**数据报封装在链路层帧中，设置源和目的 MAC 地址**。
7. 发送数据报：将封装好的帧发送到选择的网络接口。
8. 重复上述过程：如果下一个路由器也不是最终目的地，则重复上述过程，直到数据报到达最终目的地。
9. 交付数据报：当数据报到达最终目的地时，它会被交付给传输层协议（如 TCP 或 UDP）进行处理。

---

#### ICMP

1. 封装成 IP 数据包然后再传递给数据链路层。所以在 IP 数据包中如果协议类型字段的值是 1 的话，就表示 IP 数据是 ICMP 报文。
2. 分为两大类，**查询报文**和**差错报文**。0代表回答，8代表请求

##### ping

除了类型和代码字段，还被追加了标识符和序号字段。标识符和序号字段分别是 16 位的字段。ping 命令在发送回显请求数据包时，会将进程号填写在标识符里。对于序号，每送出一个数据包数值就增加1。

记住发送回显请求数据包的时间，与接收到回显应答数据包的时间差，就能计算出数据包一去一回所需要的时间。

##### traceroute

会将 IP 包的 TTL 设置 为 1，然后发送 UDP 包，他会填入一个端口号作为 UDP 目标端口号（默认是：33434-33534）。

当目的主机收到 UDP 包后，会返回 ICMP 差错报文消息（类型 3，代码 3）。参照上面的表，该错报文类型是端口不可达，说明发送方发出的 UDP 包到达了目的主机。

---

#### SYN 泛洪攻击

不断发送SYN给服务端主机，然后发送ACK，使得服务端一直创建半连接，直到宕机。

解决方法： 